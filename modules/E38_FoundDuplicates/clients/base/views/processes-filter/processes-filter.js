({active_processes:{},process_filter:[],name_filter:[],show_ignored_filter:[],events:{'change #e38_process_selection':'filterProcesses','keyup #e38_duplicate_name':'callFilterByDuplicateName','paste #e38_duplicate_name':'callFilterByDuplicateName','change #e38_show_ignored':'showIgnoredFilter',},initialize:function(options){this._super('initialize',[options]);this.show_ignored_filter=[{'ignore_pair':{$equals:0}}];var processes_collection=app.data.createBeanCollection('E38_DuplicateFinderProcess');processes_collection.fetch({limit:-1,filter:{filter:[{active:{$equals:'yes'}}]},success:function(response){this.context.active_deduplicate_processes={};this.active_processes={};$.each(response.models,function(index,process){this.context.active_deduplicate_processes[process.get('id')]=process.get('name');var module_label=app.lang.getModuleName(process.get('for_module'),{plural:true});this.active_processes[process.get('id')]=process.get('name')+' ('+module_label+')';}.bind(this));this.render();}.bind(this),error:function(error){app.alert.show('server-error',{level:'error',messages:app.lang.get('LBL_E38_GENERIC_ERROR'),});},});},filterProcesses:function(event){var target=$(event.target);var ctx=this.options.context;var ctxCollection=ctx.get('collection');if(target.val()!=''){this.process_filter=[{'e38_duplicatecheck.duplicate_finder_process_id':{$equals:target.val()}}];}else{this.process_filter=[];}
var options={showAlerts:true,apiOptions:{},};ctxCollection.filterDef=this.process_filter.concat(this.name_filter,this.show_ignored_filter);ctxCollection.origFilterDef=ctxCollection.origFilterDef||[];ctx.resetLoadFlag({recursive:false});ctx.set('skipFetch',false);ctx.loadData(options);},callFilterByDuplicateName:_.debounce(function(event){if($(event.target).val().trim()!=''&&$(event.target).val().length<3){return;}
this.filterByDuplicateName(event);},400),filterByDuplicateName:function(event){var target=$(event.target);var ctx=this.options.context;var ctxCollection=ctx.get('collection');if(target.val().trim()!=''){this.name_filter=[{$or:[{duplicate_record_1_name:{$starts:'%'+target.val(),},},{duplicate_record_2_name:{$starts:'%'+target.val()}}],}];}else{this.name_filter=[];}
var options={showAlerts:true,apiOptions:{},};ctxCollection.filterDef=this.process_filter.concat(this.name_filter,this.show_ignored_filter);ctxCollection.origFilterDef=ctxCollection.origFilterDef||[];ctx.resetLoadFlag({recursive:false});ctx.set('skipFetch',false);ctx.loadData(options);},showIgnoredFilter:function(event){var show_ignored=typeof event!='undefined'?$(event.target).is(':checked'):false;var ctx=this.options.context;var ctxCollection=ctx.get('collection');if(show_ignored){this.show_ignored_filter=[{$or:[{ignore_pair:{$equals:0}},{ignore_pair:{$equals:1}}],}];}else{this.show_ignored_filter=[{ignore_pair:{$equals:0}}];}
var options={showAlerts:true,apiOptions:{},};ctxCollection.filterDef=this.process_filter.concat(this.name_filter,this.show_ignored_filter);ctxCollection.origFilterDef=ctxCollection.origFilterDef||[];ctx.resetLoadFlag({recursive:false});ctx.set('skipFetch',false);ctx.loadData(options);},});