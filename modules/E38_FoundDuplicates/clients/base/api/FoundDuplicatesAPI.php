<?php

/**
 * @author 38 Elements DOO
 *
 * 38 Elements DOO ("COMPANY") CONFIDENTIAL
 *
 * Copyright (c) 2020 38 Elements DOO, Belgrade, Serbia - All Rights Reserved
 *
 * NOTICE:  All information contained herein is, and remains the property
 * of COMPANY. The intellectual and technical concepts contained herein are
 * proprietary to COMPANY and may be covered by Serbia and Foreign Patents,
 * patents in process, and are protected by trade secret or copyright law.
 * Dissemination of this information or reproduction of this material is strictly
 * forbidden unless prior written permission is obtained from COMPANY.
 * Access to the source code contained herein is hereby forbidden to anyone except
 * current COMPANY employees, managers or contractors who have executed
 * Confidentiality and Non-disclosure agreements explicitly covering such access.
 *
 * The copyright notice above does not evidence any actual or intended publication
 * or disclosure  of  this source code, which includes information that is
 * confidential and/or proprietary, and is a trade secret, of  COMPANY.
 * ANY REPRODUCTION, MODIFICATION, DISTRIBUTION, PUBLIC  PERFORMANCE,OR PUBLIC
 * DISPLAY OF OR THROUGH USE  OF THIS  SOURCE CODE  WITHOUT  THE EXPRESS WRITTEN
 * CONSENT OF COMPANY IS STRICTLY PROHIBITED, AND IN VIOLATION OF APPLICABLE LAWS
 * AND INTERNATIONAL TREATIES. THE RECEIPT OR POSSESSION OF  THIS SOURCE CODE
 * AND/OR RELATED INFORMATION DOES NOT CONVEY OR IMPLY ANY RIGHTS TO REPRODUCE,
 * DISCLOSE OR DISTRIBUTE ITS CONTENTS, OR TO MANUFACTURE, USE, OR SELL ANYTHING
 * THAT IT  MAY DESCRIBE, IN WHOLE OR IN PART.
 *
 * Please contact 38 Elements DOO for further details at office@38elements.com
 */
 
  class FoundDuplicatesAPI extends SugarApi { public function registerApiRest() { return array("\162\x65\164\162\151\x65\166\x65\x44\165\x70\x6c\x69\143\141\164\145\x73" => array("\162\x65\x71\124\x79\160\x65" => "\x47\x45\x54", "\160\141\x74\x68" => array("\x45\63\x38\x5f\106\x6f\165\156\x64\104\x75\x70\x6c\151\143\141\164\145\163", "\162\x65\164\162\151\x65\166\145\x2d\x64\x75\160\154\151\143\x61\164\145\163", "\77", "\77"), "\160\141\x74\150\126\141\x72\163" => array("\160\162\145\x66\x69\170", "\x61\x63\164\151\x6f\x6e", "\146\x6f\x72\137\x6d\157\x64\165\x6c\145", "\157\x72\x69\x67\x69\156\141\154\137\x72\x65\x63\x6f\x72\144\x5f\151\x64"), "\x6d\x65\164\150\157\144" => "\162\x65\164\x72\151\145\x76\145\x44\165\x70\x6c\x69\x63\141\x74\x65\163")); } public function retrieveDuplicates($api, $args) { global $current_user, $timedate; if (!empty($args["\146\157\162\137\x6d\x6f\x64\x75\154\145"])) { goto KADlc; } throw new SugarApiExceptionMissingParameter("\x4c\x42\x4c\137\106\x4f\122\x5f\x4d\x4f\104\125\x4c\x45\137\x4d\111\x53\x53\111\116\x47", '', "\105\63\70\x5f\106\x6f\165\x6e\144\x44\165\160\154\x69\143\x61\x74\x65\163"); KADlc: if (!empty($args["\x6f\162\x69\x67\x69\156\x61\154\x5f\x72\145\143\x6f\162\x64\137\151\144"])) { goto Gdmd0; } throw new SugarApiExceptionMissingParameter("\114\102\x4c\137\122\105\x43\x4f\x52\x44\x5f\111\x44\137\x4d\x49\123\123\111\x4e\x47", '', "\105\63\x38\137\106\x6f\165\156\x64\x44\x75\x70\x6c\x69\x63\x61\x74\x65\x73"); Gdmd0: $existing_processes = $GLOBALS["\x64\x62"]->query("\xa\40\x20\x20\x20\40\40\40\40\x20\x20\x20\40\x53\x45\x4c\x45\103\x54\40\151\x64\40\12\40\40\x20\x20\x20\40\x20\40\x20\x20\x20\x20\106\x52\x4f\115\x20\x65\x33\70\137\x64\165\160\154\151\143\141\164\x65\146\x69\156\x64\x65\x72\160\162\157\x63\145\163\163\12\40\40\x20\x20\40\40\x20\40\x20\x20\40\40\127\x48\x45\x52\x45\40\x66\x6f\162\137\155\x6f\x64\165\x6c\x65\40\75\x20\x27{$args["\x66\x6f\x72\x5f\155\157\144\165\154\145"]}\x27\x20\x41\x4e\x44\x20\144\x65\x6c\145\x74\145\x64\40\x3d\x20\x30\73\xa\x20\40\x20\x20\40\x20\x20\x20"); if ($GLOBALS["\x64\x62"]->getRowCount($existing_processes)) { goto kf0HO; } throw new SugarApiExceptionMissingParameter("\x4c\102\x4c\x5f\116\117\137\101\x43\124\111\126\x45\x5f\x50\122\117\103\x45\x53\123\105\123", '', "\x45\x33\70\x5f\x46\x6f\165\x6e\x64\x44\165\160\x6c\x69\x63\141\x74\145\163"); kf0HO: $existing_found_duplicates = $GLOBALS["\144\142"]->query("\xa\x20\40\40\40\40\x20\40\x20\x20\x20\40\40\123\105\114\x45\103\x54\x20\x44\111\x53\x54\111\x4e\x43\x54\x20\145\63\70\x5f\146\x6f\165\x6e\x64\x64\165\160\154\x69\x63\x61\x74\x65\x73\56\x64\x61\164\145\x5f\x65\x6e\x74\145\x72\x65\144\54\40\x65\63\x38\x5f\144\x75\160\154\x69\x63\141\x74\x65\x66\151\x6e\144\x65\x72\x70\162\x6f\143\x65\x73\x73\56\x66\x6f\x72\137\155\x6f\x64\x75\x6c\145\x2c\40\x65\63\x38\137\146\x6f\x75\x6e\x64\144\x75\x70\x6c\x69\143\x61\x74\x65\163\x2e\144\x75\x70\154\x69\143\141\164\x65\x5f\162\x65\x63\x6f\162\144\x5f\151\x64\x5f\61\54\40\x65\x33\70\137\x66\x6f\165\156\144\x64\165\x70\154\x69\143\x61\x74\145\x73\56\144\165\160\154\x69\x63\x61\x74\145\137\162\145\143\x6f\x72\x64\x5f\x31\137\156\x61\x6d\x65\x2c\x20\x65\63\70\x5f\x66\x6f\x75\x6e\x64\x64\165\x70\154\151\143\141\164\x65\163\x2e\x64\x75\160\154\151\x63\141\x74\x65\137\162\145\143\157\x72\x64\x5f\151\x64\x5f\x32\54\x20\145\x33\70\x5f\x66\157\x75\x6e\144\144\165\160\x6c\151\143\x61\164\x65\163\56\144\x75\160\154\x69\143\141\x74\x65\137\162\145\x63\157\162\144\x5f\x32\x5f\156\x61\x6d\145\54\40\145\63\70\137\x66\x6f\x75\x6e\144\144\x75\160\154\151\x63\141\x74\145\x73\x2e\x69\147\156\x6f\162\x65\x5f\160\x61\151\x72\54\40\145\x33\x38\137\x64\x75\x70\x6c\x69\143\141\164\x65\x66\151\156\144\145\162\x70\x72\x6f\x63\x65\163\x73\56\x69\x64\x2c\x20\x65\63\70\137\144\x75\160\x6c\x69\x63\141\x74\145\146\151\156\x64\145\162\160\x72\157\143\145\163\x73\56\156\x61\x6d\145\x2c\x20\x65\63\x38\x5f\146\157\x75\156\x64\144\x75\160\x6c\151\143\141\x74\145\x73\x2e\x69\144\x20\x41\x53\40\146\x6f\165\156\x64\137\x64\165\160\x6c\151\x63\141\164\x65\163\137\151\144\40\xa\x20\40\x20\x20\40\40\x20\40\40\x20\x20\x20\x46\122\117\115\x20\x65\63\70\x5f\146\157\x75\x6e\x64\144\x75\x70\154\x69\x63\141\x74\x65\x73\40\xa\x20\40\x20\40\x20\40\40\x20\40\x20\x20\40\x20\x20\x20\x20\112\x4f\111\x4e\x20\x65\x33\x38\137\x64\165\x70\x6c\151\x63\141\164\145\x63\150\145\x63\153\x5f\145\63\70\137\x66\157\165\x6e\x64\144\165\160\154\151\143\x61\x74\145\163\x20\x4f\116\x20\x65\x33\x38\137\x66\x6f\165\x6e\x64\x64\x75\x70\154\x69\x63\x61\x74\145\x73\56\x69\144\x20\x3d\40\x65\63\70\137\x64\x75\x70\154\x69\x63\141\x74\145\x63\x68\145\143\153\137\x65\63\70\x5f\x66\x6f\165\x6e\144\x64\165\160\154\x69\143\141\x74\145\x73\56\x65\63\x38\x5f\x66\x6f\165\156\x64\144\x75\160\154\151\x63\141\164\x65\x73\137\151\x64\xa\x20\40\x20\x20\x20\x20\40\40\40\x20\40\40\40\x20\x20\40\x4a\117\x49\116\x20\x65\63\x38\137\x64\x75\160\x6c\151\143\141\x74\x65\x63\150\145\x63\x6b\x20\x4f\116\x20\x65\x33\x38\x5f\x64\x75\x70\x6c\151\143\141\x74\145\143\x68\x65\x63\153\56\151\x64\x20\75\x20\145\x33\70\137\x64\x75\x70\154\151\143\141\164\x65\x63\x68\x65\143\153\x5f\x65\63\x38\x5f\146\157\x75\156\x64\x64\165\x70\154\x69\143\141\164\x65\163\x2e\x65\x33\70\x5f\144\x75\160\154\151\x63\x61\x74\x65\143\x68\145\x63\153\137\151\144\xa\x20\40\40\x20\40\40\x20\40\x20\40\40\40\x20\x20\40\40\112\117\x49\x4e\40\x65\63\70\137\144\165\160\x6c\151\143\x61\164\x65\x66\151\156\144\145\x72\x70\162\x6f\143\x65\x73\163\x20\x4f\x4e\x20\x65\63\x38\137\144\165\160\154\151\143\141\x74\145\x66\x69\x6e\x64\x65\162\160\x72\x6f\x63\145\163\x73\56\151\x64\40\75\x20\x65\x33\70\137\144\x75\x70\x6c\x69\143\x61\164\145\143\x68\x65\143\153\x2e\x64\165\160\154\x69\143\141\164\x65\x5f\x66\151\156\144\145\162\x5f\x70\162\157\143\x65\x73\163\137\151\144\xa\x20\40\x20\x20\x20\x20\40\x20\40\x20\x20\x20\127\110\105\122\105\40\x65\x33\70\x5f\x66\157\165\156\x64\x64\165\160\x6c\151\143\x61\x74\145\x73\x2e\144\145\154\145\x74\145\144\40\x3d\40\60\40\x41\116\x44\xa\x20\x20\40\40\40\x20\x20\40\x20\x20\x20\x20\x20\40\40\x20\x20\x20\40\x20\50\x65\63\x38\x5f\146\x6f\165\x6e\x64\144\x75\x70\154\151\x63\x61\164\x65\x73\x2e\144\165\x70\x6c\151\143\x61\x74\x65\x5f\x72\x65\143\157\162\x64\x5f\x69\144\x5f\x31\40\75\x20\47{$args["\157\x72\151\147\x69\x6e\x61\154\x5f\x72\x65\x63\157\162\144\x5f\151\x64"]}\x27\x20\117\122\40\x65\x33\x38\x5f\146\157\165\x6e\x64\144\x75\160\154\151\143\x61\x74\x65\x73\x2e\x64\x75\x70\x6c\151\143\141\164\145\137\x72\145\143\157\162\144\137\151\x64\137\x32\40\x3d\40\x27{$args["\x6f\x72\151\147\x69\x6e\x61\x6c\x5f\x72\145\x63\157\x72\144\x5f\x69\x64"]}\x27\x29\x20\x41\x4e\104\40\11\11\11\x9\x9\11\11\x9\x9\11\x9\12\40\x20\x20\40\40\x20\x20\40\40\40\x20\x20\40\40\40\x20\x20\x20\40\40\x65\x33\70\x5f\x64\x75\x70\x6c\151\x63\141\x74\x65\146\151\x6e\x64\145\x72\160\x72\157\x63\x65\x73\x73\56\x66\157\162\137\155\157\144\x75\x6c\145\40\x3d\x20\47{$args["\146\157\162\137\x6d\x6f\x64\165\x6c\145"]}\47\73\xa\x20\x20\40\40\x20\40\40\x20"); $found_duplicates_pairs = array(); KRgp7: if (!($row = $GLOBALS["\144\x62"]->fetchByAssoc($existing_found_duplicates))) { goto Cq60H; } $date_detected = $timedate->fromDb($row["\x64\141\x74\145\137\x65\x6e\164\145\162\145\x64"]); $date_detected_user_format = $timedate->asUser($date_detected, $current_user); $found_duplicates_pairs[] = array("\144\165\x70\x6c\x69\143\141\164\x65\137\151\144" => $args["\157\x72\151\147\151\156\141\154\x5f\x72\145\x63\x6f\162\144\x5f\x69\x64"] == $row["\x64\165\160\154\x69\143\141\x74\145\x5f\162\x65\143\x6f\x72\144\x5f\151\144\x5f\x31"] ? $row["\x64\x75\160\x6c\151\x63\x61\x74\145\x5f\x72\x65\x63\157\162\144\x5f\x69\144\x5f\x32"] : $row["\x64\x75\160\x6c\151\143\x61\x74\145\x5f\162\x65\143\157\x72\x64\x5f\x69\144\x5f\x31"], "\x64\x75\x70\x6c\151\x63\141\x74\145\137\156\x61\x6d\145" => $args["\157\x72\151\x67\151\156\141\154\x5f\162\145\143\157\x72\x64\137\x69\144"] == $row["\x64\x75\160\x6c\x69\143\x61\x74\145\x5f\162\x65\x63\x6f\x72\144\x5f\x69\144\137\x31"] ? $row["\x64\x75\160\154\x69\143\x61\164\x65\x5f\x72\145\143\157\x72\x64\137\x32\137\x6e\141\x6d\x65"] : $row["\x64\165\x70\x6c\151\143\x61\x74\x65\x5f\x72\x65\x63\x6f\162\x64\137\61\137\x6e\x61\155\145"], "\146\157\162\x5f\x6d\157\144\x75\x6c\145" => $row["\146\x6f\x72\137\x6d\157\144\x75\x6c\145"], "\x69\147\x6e\157\x72\145\x5f\160\141\x69\162" => (int) $row["\x69\147\156\157\162\x65\x5f\160\141\151\162"], "\160\x72\x6f\143\145\163\x73\137\151\x64" => $row["\x69\x64"], "\160\x72\x6f\x63\145\163\163\x5f\x6e\x61\x6d\x65" => $row["\x6e\x61\x6d\x65"], "\x64\x61\164\145\137\144\x65\x74\x65\x63\x74\x65\144" => $date_detected_user_format, "\x66\157\165\156\144\137\x64\x75\x70\154\x69\x63\141\x74\145\x73\x5f\151\144" => $row["\x66\x6f\x75\x6e\x64\137\x64\165\x70\154\x69\x63\141\x74\x65\x73\x5f\x69\144"]); goto KRgp7; Cq60H: return array("\x73\x75\x63\x63\145\x73\163" => true, "\x66\157\x75\156\x64\137\x64\x75\x70\x6c\x69\143\x61\164\145\163" => $found_duplicates_pairs); } }
